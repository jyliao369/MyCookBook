{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Justin\\\\Desktop\\\\Coding\\\\mycookbook prototype\\\\mycookbookver3\\\\client\\\\src\\\\components\\\\RecipeForm\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react'; // import { useContext } from 'react';\n\nimport { useState } from 'react'; // import { Link } from 'react-router-dom';\n\nimport { useMutation } from '@apollo/client';\nimport { ADD_RECIPE } from '../../utils/mutations';\nimport { QUERY_RECIPES, QUERY_MYPROFILE } from '../../utils/queries';\nimport Axios from 'axios'; // import { Image } from 'cloudinary-react';\n\nimport Auth from '../../utils/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst RecipeForm = () => {\n  _s();\n\n  const [newRecipe, setNewRecipe] = useState({\n    title: '',\n    category: '',\n    servings: '',\n    totalTime: '',\n    ingredients: [''],\n    directions: [''],\n    imageid: ''\n  });\n  console.log(\"New Recipe\");\n  console.log(newRecipe); // console.log(newRecipe.directions);\n  // THIS SHOULD HANDLE THE IMAGES BEING UPLOADED\n  // IT SHOULD ALSO GENERATE PUBLIC ID FOR THE IMAGE\n\n  const [imageSelected, setImageSelected] = useState(\"\"); // const [imageID, setImageID] = useState(\"\");\n\n  const uploadImage = file => {\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    formData.append(\"upload_preset\", \"yun8815z\");\n    Axios.post(\"https://api.cloudinary.com/v1_1/du119g90a/image/upload\", formData).then(response => {\n      console.log(\"response\");\n      console.log(response);\n      console.log(\"public ID\");\n      console.log(response.data.public_id);\n      setNewRecipe(prevState => ({ ...prevState,\n        imageid: response.data.public_id\n      }));\n    });\n  };\n\n  const handleChange = event => {\n    const {\n      name,\n      value\n    } = event.target;\n\n    if (name === \"title\") {\n      setNewRecipe(prevState => ({ ...prevState,\n        title: value\n      }));\n    }\n\n    if (name === \"category\") {\n      setNewRecipe(prevState => ({ ...prevState,\n        category: value\n      }));\n    }\n\n    if (name === \"servings\") {\n      setNewRecipe(prevState => ({ ...prevState,\n        servings: value\n      }));\n    }\n\n    if (name === \"totalTime\") {\n      setNewRecipe(prevState => ({ ...prevState,\n        totalTime: value\n      }));\n    }\n\n    if (name === 'ingredients') {\n      let ingredientsarray = [];\n      let testingredientsarray = value.split(\"\\n\");\n\n      for (let a = 0; a < testingredientsarray.length; a++) {\n        ingredientsarray.push(testingredientsarray[a]);\n        setNewRecipe(prevState => ({ ...prevState,\n          ingredients: ingredientsarray\n        }));\n      }\n\n      ;\n    }\n\n    if (name === 'directions') {\n      let directionssarray = [];\n      let testdirectionsarray = value.split(\"\\n\");\n\n      for (let b = 0; b < testdirectionsarray.length; b++) {\n        directionssarray.push(testdirectionsarray[b]);\n        setNewRecipe(prevState => ({ ...prevState,\n          directions: directionssarray\n        }));\n      }\n\n      ;\n    }\n  };\n\n  const [addRecipe, {\n    error\n  }] = useMutation(ADD_RECIPE, {\n    update(cache, {\n      data: {\n        addRecipe\n      }\n    }) {\n      try {\n        const {\n          recipes\n        } = cache.readQuery({\n          query: QUERY_RECIPES\n        });\n        cache.writeQuery({\n          query: QUERY_RECIPES,\n          data: {\n            recipes: [addRecipe, ...recipes]\n          }\n        });\n      } catch (e) {\n        console.error(e);\n      }\n\n      const {\n        myprofile\n      } = cache.readQuery({\n        query: QUERY_MYPROFILE\n      });\n      cache.writeQuery({\n        query: QUERY_MYPROFILE,\n        data: {\n          myprofile: { ...myprofile,\n            recipes: [...myprofile.recipes, addRecipe]\n          }\n        }\n      });\n    }\n\n  });\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n\n    try {\n      const {\n        data\n      } = await addRecipe({\n        variables: { ...newRecipe,\n          postAuthor: Auth.getProfile().data.email\n        }\n      });\n      setNewRecipe({\n        title: '',\n        category: '',\n        servings: '',\n        totalTime: '',\n        ingredients: '',\n        directions: '',\n        imageid: ''\n      }); // Auth.login(data.addRecipe)\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"recipeformsection\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"uploadImage\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        title: \" \",\n        type: \"file\",\n        onChange: event => {\n          uploadImage(event.target.files[0]);\n          setImageSelected(event.target.files[0]);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"previewImage\",\n        children: imageSelected ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: URL.createObjectURL(imageSelected),\n          className: \"imagepreview\",\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"No Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"recipeform\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Recipe Name\",\n        name: \"title\",\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Category\",\n        name: \"category\",\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Servings\",\n        name: \"servings\",\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Total Time to Cook\",\n        name: \"totalTime\",\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        placeholder: \"Ingredients\",\n        name: \"ingredients\",\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        placeholder: \"Instructions\",\n        name: \"directions\",\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"recipeformbutton\",\n          type: \"submit\",\n          children: \"Add Recipe\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: uploadImage,\n      children: \"Add Recipe\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 9\n  }, this);\n};\n\n_s(RecipeForm, \"ndPm/apx+i6/UzNk9TADOBp8gOE=\", false, function () {\n  return [useMutation];\n});\n\n_c = RecipeForm;\nexport default RecipeForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"RecipeForm\");","map":{"version":3,"sources":["C:/Users/Justin/Desktop/Coding/mycookbook prototype/mycookbookver3/client/src/components/RecipeForm/index.js"],"names":["React","useState","useMutation","ADD_RECIPE","QUERY_RECIPES","QUERY_MYPROFILE","Axios","Auth","RecipeForm","newRecipe","setNewRecipe","title","category","servings","totalTime","ingredients","directions","imageid","console","log","imageSelected","setImageSelected","uploadImage","file","formData","FormData","append","post","then","response","data","public_id","prevState","handleChange","event","name","value","target","ingredientsarray","testingredientsarray","split","a","length","push","directionssarray","testdirectionsarray","b","addRecipe","error","update","cache","recipes","readQuery","query","writeQuery","e","myprofile","handleSubmit","preventDefault","variables","postAuthor","getProfile","email","files","URL","createObjectURL"],"mappings":"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","sourcesContent":["import React from 'react';\r\n// import { useContext } from 'react';\r\nimport { useState } from 'react';\r\n\r\n// import { Link } from 'react-router-dom';\r\nimport { useMutation } from '@apollo/client';\r\n\r\nimport { ADD_RECIPE } from '../../utils/mutations';\r\nimport { QUERY_RECIPES, QUERY_MYPROFILE } from '../../utils/queries';\r\n\r\nimport Axios from 'axios';\r\n// import { Image } from 'cloudinary-react';\r\n\r\nimport Auth from '../../utils/auth';\r\n\r\nconst RecipeForm = () => {\r\n\r\n    const [newRecipe, setNewRecipe] = useState({\r\n        title: '',\r\n        category: '',\r\n        servings: '',\r\n        totalTime: '',\r\n        ingredients: [''],\r\n        directions: [''],\r\n        imageid: '',\r\n    });\r\n\r\n    console.log(\"New Recipe\");\r\n    console.log(newRecipe);\r\n    // console.log(newRecipe.directions);\r\n\r\n    // THIS SHOULD HANDLE THE IMAGES BEING UPLOADED\r\n    // IT SHOULD ALSO GENERATE PUBLIC ID FOR THE IMAGE\r\n    const [imageSelected, setImageSelected] = useState(\"\");\r\n    // const [imageID, setImageID] = useState(\"\");\r\n\r\n    const uploadImage = (file) => {\r\n\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n        formData.append(\"upload_preset\", \"yun8815z\");\r\n\r\n        Axios.post(\r\n            \"https://api.cloudinary.com/v1_1/du119g90a/image/upload\", \r\n            formData\r\n        ).then((response) => {\r\n            console.log(\"response\");\r\n            console.log(response);\r\n            console.log(\"public ID\");\r\n            console.log(response.data.public_id);\r\n            \r\n            setNewRecipe((prevState) => ({\r\n\r\n                ...prevState,\r\n                imageid: response.data.public_id,\r\n            }))\r\n        });\r\n    };\r\n\r\n\r\n    const handleChange = (event) => {\r\n        const { name, value } = event.target;\r\n\r\n        if (name === \"title\") {\r\n            setNewRecipe((prevState) => ({\r\n\r\n                ...prevState,\r\n                title: value,\r\n            }))\r\n        }\r\n\r\n        if (name === \"category\") {\r\n            setNewRecipe((prevState) => ({\r\n                \r\n                ...prevState,\r\n                category: value,\r\n            }))\r\n        }\r\n\r\n        if (name === \"servings\") {\r\n            setNewRecipe((prevState) => ({\r\n\r\n                ...prevState,\r\n                servings: value,\r\n            }))\r\n        }\r\n\r\n        if (name === \"totalTime\") {\r\n            setNewRecipe((prevState) => ({\r\n\r\n                ...prevState,\r\n                totalTime: value,\r\n            }))\r\n        }\r\n\r\n        if (name === 'ingredients') {\r\n            let ingredientsarray = [];\r\n            let testingredientsarray = value.split(\"\\n\");\r\n            for (let a = 0; a < testingredientsarray.length; a++) {\r\n                ingredientsarray.push(testingredientsarray[a]);\r\n                setNewRecipe((prevState) => ({\r\n                    ...prevState,\r\n                    ingredients: ingredientsarray\r\n                }))\r\n            };\r\n        }\r\n\r\n        if (name === 'directions') {\r\n            let directionssarray = [];\r\n            let testdirectionsarray = value.split(\"\\n\");\r\n            for (let b = 0; b < testdirectionsarray.length; b++) {\r\n                directionssarray.push(testdirectionsarray[b]);\r\n                setNewRecipe((prevState) => ({\r\n                    ...prevState,\r\n                    directions: directionssarray\r\n                }))\r\n            };\r\n        }\r\n    };\r\n\r\n    const [addRecipe, { error }] = useMutation(ADD_RECIPE, {\r\n        update(cache, { data: { addRecipe } }) {\r\n            try {\r\n                const { recipes } = cache.readQuery({ query: QUERY_RECIPES });\r\n\r\n                cache.writeQuery({\r\n                    query: QUERY_RECIPES,\r\n                    data: { recipes: [addRecipe, ...recipes] },\r\n                });\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n\r\n            const { myprofile } = cache.readQuery({ query: QUERY_MYPROFILE });\r\n            cache.writeQuery({\r\n                query: QUERY_MYPROFILE,\r\n                data: { myprofile: { ...myprofile, recipes: [...myprofile.recipes, addRecipe] } },\r\n            });\r\n        },\r\n    });\r\n\r\n    const handleSubmit = async (event) => {\r\n        event.preventDefault();\r\n\r\n        try {\r\n            const { data } = await addRecipe({\r\n                variables: { \r\n                    ...newRecipe, \r\n                    postAuthor: Auth.getProfile().data.email,\r\n                },\r\n            });\r\n\r\n            setNewRecipe({\r\n                title: '',\r\n                category: '',\r\n                servings: '',\r\n                totalTime: '',\r\n                ingredients: '',\r\n                directions: '',\r\n                imageid: '',\r\n            });\r\n            \r\n            // Auth.login(data.addRecipe)\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"recipeformsection\">\r\n            <div className=\"uploadImage\">\r\n                <input \r\n                    title=\" \"\r\n                    type=\"file\" \r\n                    onChange={(event) => {\r\n                        uploadImage(event.target.files[0]);\r\n                        setImageSelected(event.target.files[0]);\r\n                    }}\r\n                />\r\n                <div className=\"previewImage\">\r\n                    {imageSelected ? (\r\n                        <img src={URL.createObjectURL(imageSelected)} className=\"imagepreview\" alt=\"\"></img>\r\n                    ) : (\r\n                        <h1>No Image</h1>\r\n                    )}\r\n                </div>\r\n            </div>\r\n            <form onSubmit={handleSubmit} className=\"recipeform\">\r\n                <input placeholder=\"Recipe Name\" name=\"title\" onChange={handleChange}></input>\r\n                <input placeholder=\"Category\" name=\"category\" onChange={handleChange}></input>\r\n                <input placeholder=\"Servings\" name=\"servings\" onChange={handleChange}></input>\r\n                <input placeholder=\"Total Time to Cook\" name=\"totalTime\" onChange={handleChange}></input>\r\n                <textarea placeholder=\"Ingredients\" name=\"ingredients\" onChange={handleChange}></textarea>\r\n                <textarea placeholder=\"Instructions\" name=\"directions\" onChange={handleChange}></textarea>\r\n                <div className=\"\">\r\n                    <button className=\"recipeformbutton\" type=\"submit\">\r\n                        Add Recipe\r\n                    </button>\r\n\r\n                </div>\r\n            </form>\r\n            <button onClick={uploadImage}>\r\n                Add Recipe\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default RecipeForm;"]},"metadata":{},"sourceType":"module"}