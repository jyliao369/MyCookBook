{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Justin/Desktop/Coding/MyCookBook/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Justin/Desktop/Coding/MyCookBook/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:/Users/Justin/Desktop/Coding/MyCookBook/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/Justin/Desktop/Coding/MyCookBook/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Justin/Desktop/Coding/MyCookBook/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useParams}from'react-router-dom';import{useQuery,useMutation}from'@apollo/client';import{ADD_RECIPE}from'../utils/mutations';import{QUERY_SINGLE_RECIPE,QUERY_MYPROFILE}from'../utils/queries';import{Image}from'cloudinary-react';import Auth from'../utils/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SingleRecipe=function SingleRecipe(){var _useParams=useParams(),recipeId=_useParams.recipeId;var _useQuery=useQuery(QUERY_SINGLE_RECIPE,{variables:{recipeId:recipeId}}),loading=_useQuery.loading,data=_useQuery.data;var recipe=(data===null||data===void 0?void 0:data.recipe)||{};// console.log(recipe)\n// console.log(recipe.title);\n// THIS SHOULD, ON PAPER ADD THE CURRENT OBJECT WHICH IS THE 'recipe'\n// FROM ABOVE AND ADD TO THE USER THAT IS CURRENTLY LOGGED. THAT'S WHAT THE\n// BELOW CODE SHOULD DO\n// const [ addedrecipe , setAddedrecipe ] = useState({\n//     title: 'hello'\n// });\n// console.log(\"testing\");\n// console.log(addedrecipe);\nvar _useMutation=useMutation(ADD_RECIPE,{update:function update(cache,_ref){var addRecipe=_ref.data.addRecipe;var _cache$readQuery=cache.readQuery({query:QUERY_MYPROFILE}),myprofile=_cache$readQuery.myprofile;cache.writeQuery({query:QUERY_MYPROFILE,data:{myprofile:_objectSpread(_objectSpread({},myprofile),{},{recipes:[].concat(_toConsumableArray(myprofile.recipes),[addRecipe])})}});}}),_useMutation2=_slicedToArray(_useMutation,2),addRecipe=_useMutation2[0],error=_useMutation2[1].error;var handleAddto=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _yield$addRecipe,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return addRecipe({variables:_objectSpread({},recipe)});case 4:_yield$addRecipe=_context.sent;_data=_yield$addRecipe.data;console.log(\"success\");_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.log(\"it didnt work\");console.error(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function handleAddto(_x){return _ref2.apply(this,arguments);};}();if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"singlerecipepage\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"titlecard\",children:[/*#__PURE__*/_jsx(\"h1\",{children:recipe.title}),Auth.loggedIn()?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:handleAddto,enabled:true,children:\"Add to Cookbook\"})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{disabled:true,children:\"Add to Cookbook\"})})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"generalInfo\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Category: \",recipe.category]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Number of Servings: \",recipe.servings]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Total Cook Time: \",recipe.totalTime]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"middlepart\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ingredientsList\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Ingredients\"}),recipe.ingredients.map(function(ingredient){return/*#__PURE__*/_jsx(\"p\",{children:ingredient});})]}),/*#__PURE__*/_jsx(\"div\",{className:\"recipeImg\",children:/*#__PURE__*/_jsx(Image,{cloudName:\"du119g90a\",public_id:recipe.imageid})})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"directionsList\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Directions\"}),recipe.directions.map(function(direction){return/*#__PURE__*/_jsx(\"p\",{children:direction});})]})]})});};export default SingleRecipe;","map":{"version":3,"sources":["C:/Users/Justin/Desktop/Coding/MyCookBook/client/src/pages/SingleRecipe.js"],"names":["React","useState","useParams","useQuery","useMutation","ADD_RECIPE","QUERY_SINGLE_RECIPE","QUERY_MYPROFILE","Image","Auth","SingleRecipe","recipeId","variables","loading","data","recipe","update","cache","addRecipe","readQuery","query","myprofile","writeQuery","recipes","error","handleAddto","event","preventDefault","console","log","title","loggedIn","category","servings","totalTime","ingredients","map","ingredient","imageid","directions","direction"],"mappings":"u0BAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CAEA,OAASC,SAAT,KAA0B,kBAA1B,CACA,OAASC,QAAT,CAAmBC,WAAnB,KAAsC,gBAAtC,CAEA,OAASC,UAAT,KAA2B,oBAA3B,CACA,OAASC,mBAAT,CAA8BC,eAA9B,KAAqD,kBAArD,CAEA,OAASC,KAAT,KAAsB,kBAAtB,CAEA,MAAOC,CAAAA,IAAP,KAAiB,eAAjB,C,6IAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB,eAAqBR,SAAS,EAA9B,CAAQS,QAAR,YAAQA,QAAR,CAEA,cAA0BR,QAAQ,CAACG,mBAAD,CAAsB,CACpDM,SAAS,CAAE,CAAED,QAAQ,CAAEA,QAAZ,CADyC,CAAtB,CAAlC,CAAQE,OAAR,WAAQA,OAAR,CAAiBC,IAAjB,WAAiBA,IAAjB,CAGA,GAAMC,CAAAA,MAAM,CAAG,CAAAD,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAEC,MAAN,GAAgB,EAA/B,CACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA,iBAA+BX,WAAW,CAACC,UAAD,CAAa,CACnDW,MADmD,iBAC5CC,KAD4C,MACZ,IAAfC,CAAAA,SAAe,MAAvBJ,IAAuB,CAAfI,SAAe,CAEnC,qBAAsBD,KAAK,CAACE,SAAN,CAAgB,CAAEC,KAAK,CAAEb,eAAT,CAAhB,CAAtB,CAAQc,SAAR,kBAAQA,SAAR,CACAJ,KAAK,CAACK,UAAN,CAAiB,CACbF,KAAK,CAAEb,eADM,CAEbO,IAAI,CAAE,CAAEO,SAAS,gCACVA,SADU,MAEbE,OAAO,8BAAOF,SAAS,CAACE,OAAjB,GAA0BL,SAA1B,EAFM,EAAX,CAFO,CAAjB,EAOH,CAXkD,CAAb,CAA1C,8CAAOA,SAAP,kBAAoBM,KAApB,kBAAoBA,KAApB,CAcA,GAAMC,CAAAA,WAAW,2FAAG,iBAAOC,KAAP,6IAChBA,KAAK,CAACC,cAAN,GADgB,sCAIWT,CAAAA,SAAS,CAAC,CAC7BN,SAAS,kBACFG,MADE,CADoB,CAAD,CAJpB,uCAIJD,KAJI,kBAIJA,IAJI,CAUZc,OAAO,CAACC,GAAR,CAAY,SAAZ,EAVY,+EAYZD,OAAO,CAACC,GAAR,CAAY,eAAZ,EACAD,OAAO,CAACJ,KAAR,cAbY,oEAAH,kBAAXC,CAAAA,WAAW,6CAAjB,CAiBA,GAAIZ,OAAJ,CAAa,CACT,mBAAO,mCAAP,CACH,CACD,mBACI,YAAK,SAAS,CAAC,kBAAf,uBAEI,oCACI,aAAK,SAAS,CAAC,WAAf,wBACI,oBAAKE,MAAM,CAACe,KAAZ,EADJ,CAEKrB,IAAI,CAACsB,QAAL,gBACG,sCACI,eAAQ,OAAO,CAAEN,WAAjB,CAA8B,OAAO,KAArC,6BADJ,EADH,cAKG,sCACI,eAAQ,QAAQ,KAAhB,6BADJ,EAPR,GADJ,cAaI,aAbJ,cAcI,aAAK,SAAS,CAAC,aAAf,wBACI,kCAAcV,MAAM,CAACiB,QAArB,GADJ,cAEI,4CAAwBjB,MAAM,CAACkB,QAA/B,GAFJ,cAGI,yCAAqBlB,MAAM,CAACmB,SAA5B,GAHJ,GAdJ,cAmBI,aAnBJ,cAoBI,aAAK,SAAS,CAAC,YAAf,wBACI,aAAK,SAAS,CAAC,iBAAf,wBACI,mCADJ,CAEKnB,MAAM,CAACoB,WAAP,CAAmBC,GAAnB,CAAuB,SAACC,UAAD,qBACpB,mBAAIA,UAAJ,EADoB,EAAvB,CAFL,GADJ,cAOI,YAAK,SAAS,CAAC,WAAf,uBACI,KAAC,KAAD,EAAO,SAAS,CAAC,WAAjB,CAA6B,SAAS,CAAEtB,MAAM,CAACuB,OAA/C,EADJ,EAPJ,GApBJ,cA+BI,aA/BJ,cAgCI,aAAK,SAAS,CAAC,gBAAf,wBACI,kCADJ,CAEKvB,MAAM,CAACwB,UAAP,CAAkBH,GAAlB,CAAsB,SAACI,SAAD,qBACnB,mBAAIA,SAAJ,EADmB,EAAtB,CAFL,GAhCJ,GAFJ,EADJ,CA6CH,CAnGD,CAqGA,cAAe9B,CAAAA,YAAf","sourcesContent":["import React, { useState } from 'react';\r\n\r\nimport { useParams } from 'react-router-dom';\r\nimport { useQuery, useMutation } from '@apollo/client';\r\n\r\nimport { ADD_RECIPE } from '../utils/mutations';\r\nimport { QUERY_SINGLE_RECIPE, QUERY_MYPROFILE } from '../utils/queries';\r\n\r\nimport { Image } from 'cloudinary-react';\r\n\r\nimport Auth from '../utils/auth';\r\n\r\nconst SingleRecipe = () => {\r\n    const { recipeId } = useParams();\r\n\r\n    const { loading, data } = useQuery(QUERY_SINGLE_RECIPE, {\r\n        variables: { recipeId: recipeId },\r\n    });\r\n    const recipe = data?.recipe || {};\r\n    // console.log(recipe)\r\n    // console.log(recipe.title);\r\n\r\n    // THIS SHOULD, ON PAPER ADD THE CURRENT OBJECT WHICH IS THE 'recipe'\r\n    // FROM ABOVE AND ADD TO THE USER THAT IS CURRENTLY LOGGED. THAT'S WHAT THE\r\n    // BELOW CODE SHOULD DO\r\n\r\n    // const [ addedrecipe , setAddedrecipe ] = useState({\r\n    //     title: 'hello'\r\n    // });\r\n    // console.log(\"testing\");\r\n    // console.log(addedrecipe);\r\n\r\n    const [addRecipe, { error }] = useMutation(ADD_RECIPE, {\r\n        update(cache, { data: { addRecipe } }) {\r\n\r\n            const { myprofile } = cache.readQuery({ query: QUERY_MYPROFILE });\r\n            cache.writeQuery({\r\n                query: QUERY_MYPROFILE,\r\n                data: { myprofile: {\r\n                    ...myprofile,\r\n                    recipes: [ ...myprofile.recipes, addRecipe]\r\n                }},\r\n            });\r\n        },\r\n    });\r\n\r\n    const handleAddto = async (event) => {\r\n        event.preventDefault();\r\n\r\n        try {\r\n            const { data } = await addRecipe({\r\n                variables: {\r\n                    ...recipe,\r\n                }\r\n            });\r\n\r\n            console.log(\"success\");\r\n        } catch (err) {\r\n            console.log(\"it didnt work\");\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return <div>Loading...</div>;\r\n    }\r\n    return (\r\n        <div className=\"singlerecipepage\">\r\n            \r\n            <div>\r\n                <div className=\"titlecard\">\r\n                    <h1>{recipe.title}</h1>\r\n                    {Auth.loggedIn() ? (\r\n                        <>\r\n                            <button onClick={handleAddto} enabled>Add to Cookbook</button>\r\n                        </>\r\n                    ): (\r\n                        <>\r\n                            <button disabled>Add to Cookbook</button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <hr/>\r\n                <div className=\"generalInfo\">\r\n                    <p>Category: {recipe.category}</p>\r\n                    <p>Number of Servings: {recipe.servings}</p>\r\n                    <p>Total Cook Time: {recipe.totalTime}</p>\r\n                </div>\r\n                <hr/>\r\n                <div className=\"middlepart\">\r\n                    <div className=\"ingredientsList\">\r\n                        <h1>Ingredients</h1>\r\n                        {recipe.ingredients.map((ingredient) => (\r\n                            <p>{ingredient}</p>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"recipeImg\">\r\n                        <Image cloudName=\"du119g90a\" public_id={recipe.imageid} />\r\n                    </div>\r\n                </div>\r\n                <hr/>\r\n                <div className=\"directionsList\">\r\n                    <h1>Directions</h1>\r\n                    {recipe.directions.map((direction) => (\r\n                        <p>{direction}</p>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n            \r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SingleRecipe;"]},"metadata":{},"sourceType":"module"}